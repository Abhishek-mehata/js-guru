# Promise Chaining in JavaScript

## What is Promise Chaining?

Promise chaining is a technique that allows you to execute multiple asynchronous operations in sequence, where each operation waits for the previous one to complete before starting.

**Simple definition:** Calling multiple `.then()` handlers one after another, where the result of one `.then()` is passed to the next.

---

## Basic Syntax

```javascript
promise
  .then((result) => {
    // handle result
    return newValue; // passes to next then
  })
  .then((newValue) => {
    // handle newValue
  })
  .catch((error) => {
    // handle any error in the chain
  });
```

---

## How It Works

Each `.then()` returns a **new promise**, which allows the next `.then()` to wait for the previous one to complete. This creates a chain of sequential operations.

---

## Example 1: Basic Promise Chaining with Values

```javascript
new Promise((resolve, reject) => {
  setTimeout(() => resolve(10), 1000);
})
  .then((num) => {
    console.log("1. Got:", num); // Output: 1. Got: 10
    return num * 2; // passes 20 to next then
  })
  .then((num) => {
    console.log("2. Got:", num); // Output: 2. Got: 20
    return num * 3; // passes 60 to next then
  })
  .then((num) => {
    console.log("3. Got:", num); // Output: 3. Got: 60
  });
```

**Flow:**

1. Initial promise resolves with `10` after 1 second
2. First `.then()` receives `10`, multiplies by 2, returns `20`
3. Second `.then()` receives `20`, multiplies by 3, returns `60`
4. Third `.then()` receives `60` and logs it

---

## Example 2: Real-World Use Case - Fetching User and Posts

```javascript
function fetchUser() {
  return new Promise((resolve) => {
    setTimeout(() => resolve({ id: 1, name: "Abhishek" }), 1000);
  });
}

function fetchPosts(userId) {
  return new Promise((resolve) => {
    setTimeout(() => resolve(["Post 1", "Post 2"]), 1000);
  });
}

fetchUser()
  .then((user) => {
    console.log("User:", user); // Output: User: { id: 1, name: "Abhishek" }
    return fetchPosts(user.id); // returns another promise
  })
  .then((posts) => {
    console.log("Posts:", posts); // Output: Posts: ["Post 1", "Post 2"]
  })
  .catch((err) => {
    console.error("Error:", err);
  });
```

**Flow:**

1. `fetchUser()` resolves → gives user info
2. Result goes to the next `.then()`
3. `fetchPosts(user.id)` runs → returns a new promise
4. Next `.then()` handles the posts
5. `.catch()` handles any error that occurs anywhere in the chain

---

## Example 3: Sequential Task Execution

```javascript
function task(message, delay) {
  return new Promise((resolve) => {
    setTimeout(() => {
      console.log(message);
      resolve();
    }, delay);
  });
}

// Chaining promises to run tasks sequentially
task("Task 1 completed", 1000)
  .then(() => task("Task 2 completed", 2000))
  .then(() => task("Task 3 completed", 1000));
```

**Output:**

```
Task 1 completed (after 1 second)
Task 2 completed (after 2 more seconds)
Task 3 completed (after 1 more second)
```

**Total time:** 4 seconds (sequential execution)

---

## Example 4: Processing Data Through Multiple Steps

```javascript
function getData() {
  return new Promise((resolve) => {
    setTimeout(() => resolve([1, 2, 3, 4, 5]), 1000);
  });
}

getData()
  .then((data) => {
    console.log("Original data:", data);
    return data.map((n) => n * 2); // double each number
  })
  .then((doubled) => {
    console.log("Doubled:", doubled);
    return doubled.filter((n) => n > 5); // filter numbers > 5
  })
  .then((filtered) => {
    console.log("Filtered:", filtered);
    return filtered.reduce((sum, n) => sum + n, 0); // sum them up
  })
  .then((sum) => {
    console.log("Sum:", sum);
  })
  .catch((err) => {
    console.error("Error:", err);
  });
```

**Output:**

```
Original data: [1, 2, 3, 4, 5]
Doubled: [2, 4, 6, 8, 10]
Filtered: [6, 8, 10]
Sum: 24
```

---

## Common Mistakes to Avoid

### ❌ Forgetting to return

```javascript
fetchUser()
  .then((user) => {
    fetchPosts(user.id); // Missing return!
  })
  .then((posts) => {
    console.log(posts); // undefined!
  });
```

### ✅ Correct way

```javascript
fetchUser()
  .then((user) => {
    return fetchPosts(user.id); // Return the promise
  })
  .then((posts) => {
    console.log(posts); // Works correctly
  });
```

---

## Promise Chaining vs Callback Hell

### Before (Callback Hell):

```javascript
asyncTask1((result1) => {
  asyncTask2(result1, (result2) => {
    asyncTask3(result2, (result3) => {
      console.log(result3);
    });
  });
});
```

### After (Promise Chaining):

```javascript
asyncTask1()
  .then((result1) => asyncTask2(result1))
  .then((result2) => asyncTask3(result2))
  .then((result3) => console.log(result3))
  .catch((err) => console.error(err));
```

**Much cleaner and easier to read!**

---

---

## 🤝 Contributing

Feel free to contribute to this guide by adding more examples or improving explanations!

---

## 📄 License

This guide is free to use for learning purposes.

---

**Made with ❤️ by [Abhishek Mehata](https://github.com/Abhishek-mehata)**

Happy Learning! 🚀