# Event Propagation

Event propagation is the process of how events travel through the DOM tree when they occur.
When you click on an element, the event doesn't just affect that element‚Äîit travels through the entire DOM hierarchy.

##### When an event occurs (like a `click`), it travels through the DOM in 3 phases:

<!-- - ##### 1.`Capturing Phase` (top ‚Üí down) = The event travels from the top (window) down to the target element.

- ##### 2.`Target Phase` (actual target) = The event reaches the actual element that was interacted with.

- ##### 3.`Bubbling Phase` (bottom ‚Üí up) =  The event bubbles up from the target element back to the top. -->

```
1. üîΩ Capturing Phase (top ‚Üí down)
   - Event travels from window down to target element

2. üéØ Target Phase (actual target)
   - Event reaches the element that was clicked

3. üîº Bubbling Phase (bottom ‚Üí up)
   - Event bubbles up from target back to window
```

---

<!--  -->

## Event Listener Syntax

- ##### An event listener contains three parameters and it can be defined using the following syntax.

```js
element.addEventListener(eventType, callbackFunction, options);
```

- ##### `eventType`: String like 'click', 'keyup', 'keydown'

- ##### `callbackFunction`: This function fires after the event happened.
<!--
- ##### `{capture: boolean}`: It tells whether the event will be in the capture phase or in the bubbling phase(optional)
- ##### We can also directly give `true` or `false` instead of `{capture: boolean}` -->
- ##### `options`: Object or boolean controlling event phase
  - `{ capture: true }` = Capturing phase
  - `{ capture: false }` = Bubbling phase (default)
  - You can also use true/false directly

---

### üîÅ 1. Event Bubbling (Default)

- ##### The event starts from the clicked element, then moves up to its parent, grandparent, etc.
- ##### Like a bubble rising up ü´ß
- ##### Direction: Inner element ‚Üí Outer element (bottom to top) ü´ß

```html
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Poppins", sans-serif;
      }

      body {
        background: linear-gradient(135deg, #e0eafc, #cfdef3);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      .main-heading h1 {
        font-size: 2.5rem;
        color: #2c3e50;
        text-align: center;
        margin-bottom: 40px;
        text-transform: uppercase;
        letter-spacing: 2px;
        position: relative;
      }

      .main-heading h1::after {
        content: "";
        width: 80px;
        height: 4px;
        background: #3498db;
        display: block;
        margin: 10px auto 0;
        border-radius: 2px;
      }

      /* Grand Parent */
      #gp {
        background: #3498db;
        color: white;
        padding: 30px;
        border-radius: 15px;
        text-align: center;
        font-size: 1.2rem;
        width: 450px;
        /* height: 500px; */
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        transition: transform 0.3s ease;
      }

      #gp:hover {
        transform: scale(1.05);
      }

      /* Parent */
      #p {
        background: #2980b9;
        padding: 20px;
        margin-top: 15px;
        border-radius: 12px;
        font-size: 1rem;
        box-shadow: inset 0 3px 8px rgba(0, 0, 0, 0.2);
      }

      /* Grand Child */
      #gc {
        background: #1abc9c;
        padding: 15px;
        margin-top: 10px;
        border-radius: 10px;
        font-size: 0.95rem;
        color: #fff;
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
        transition: background 0.3s ease;
      }

      #gc:hover {
        background: #16a085;
      }
    </style>
  </head>
  <body>
    <div class="main-heading">
      <h1>Abhishek Mehata</h1>
    </div>

    <div id="gp">
      Grand Parent

      <div id="p">
        Parent
        <div id="gc">Grand Child</div>
      </div>
    </div>

    <script>
      let grandParent = document.querySelector("#gp");
      let parent = document.querySelector("#p");
      let grandChild = document.querySelector("#gc");

      grandparent.addEventListener(
        "click",
        () => {
          console.log("Grandparent clicked");
        },
        false
      ); // or { capture: false }

      parent.addEventListener(
        "click",
        () => {
          console.log("Parent clicked");
        },
        false
      );

      child.addEventListener(
        "click",
        () => {
          console.log("Child clicked");
        },
        false
      );

      // grandParent.addEventListener("click", (e) => {
      // 	console.log("GrandParent");
      // },);

      // grandParent.addEventListener("click", (e) => {
      // 	console.log("GrandParent");
      // },false);

      // grandParent.addEventListener("click", (e) => {
      // 	console.log("GrandParent");
      // },{capture:false});
    </script>
  </body>
</html>
```

- ##### When you click the child div:

```
Output:
Child clicked
Parent clicked
Grandparent clicked
```

##### The #gc (grandchild) fires first since it was clicked. Since #gc is inside #p (parent), the #p event fires next. Since #p is inside #gp (grandparent), the #gp event fires last.

##### Flow: #gc ‚Üí #p ‚Üí #gp (inner to outer)

---

## Event Capturing

- ##### The event starts from the top of the DOM and "captures" down to the target element.

- ##### In the above example, let us change the value of the third parameter of `addEventListener()` and see what changes will be made in the output.

```js
let grandParent = document.querySelector("#gp");
let parent = document.querySelector("#p");
let grandChild = document.querySelector("#gc");

grandparent.addEventListener(
  "click",
  () => {
    console.log("Grandparent clicked");
  },
  true
); // or { capture: true }

parent.addEventListener(
  "click",
  () => {
    console.log("Parent clicked");
  },
  true
);

child.addEventListener(
  "click",
  () => {
    console.log("Child clicked");
  },
  true
);
```

- ##### When you click the child div:

```
Output:
Grandparent clicked
Parent clicked
Child clicked
```

- ##### In event capturing, the #gp (grandparent) event fires first, then #p (parent), and finally #gc (grandchild). The event "captures" from the outermost container down to the clicked element.
- ##### Capturing flow: #gp ‚Üí #p ‚Üí #gc (outer to inner)

- ##### So, the process of propagating from the farthest element to the closest element in the DOM is called event capturing. Both terms are just opposite of each other.

---

### Mixed Capturing and Bubbling

- ##### Let‚Äôs play around more with the code for better understanding.

```js
let grandParent = document.querySelector("#gp");
let parent = document.querySelector("#p");
let grandChild = document.querySelector("#gc");

// Capturing phase listeners
grandparent.addEventListener(
  "click",
  () => {
    console.log("Grandparent CAPTURING");
  },
  true
);

parent.addEventListener(
  "click",
  () => {
    console.log("Parent CAPTURING");
  },
  true
);

child.addEventListener(
  "click",
  () => {
    console.log("Child CAPTURING");
  },
  true
);

// Bubbling phase listeners
grandparent.addEventListener(
  "click",
  () => {
    console.log("Grandparent BUBBLING");
  },
  false
);

parent.addEventListener(
  "click",
  () => {
    console.log("Parent BUBBLING");
  },
  false
);

child.addEventListener(
  "click",
  () => {
    console.log("Child BUBBLING");
  },
  false
);
```

- ##### When you click the child div:

```
Output:
Grandparent CAPTURING
Parent CAPTURING
Child CAPTURING
Child BUBBLING
Parent BUBBLING
Grandparent BUBBLING
```

```js
// When you click #gc (grandchild):

// 1. Capturing phase fires first (top to bottom)
// #gp capturing ‚Üí #p capturing ‚Üí #gc capturing

// 2. Then bubbling phase fires (bottom to top)
// #gc bubbling ‚Üí #p bubbling ‚Üí #gp bubbling
```

---

### Stop Event Propagation

- ##### In the above example, we can see a parameter `e` (or sometimes called as `event`) in the callback function of `addEventListener()`.
- ##### It is an event object which automatically defines when we add an event listener to an element.
- ##### This object `e` has a function called `stopPropagation()` which helps to prevent this annoying behavior.

- Use event.stopPropagation() to prevent the event from continuing its journey:

```js
let grandParent = document.querySelector("#gp");
let parent = document.querySelector("#p");
let grandChild = document.querySelector("#gc");

grandparent.addEventListener("click", () => {
  console.log("Grandparent clicked");
});

parent.addEventListener("click", (event) => {
  event.stopPropagation(); // Stop here!
  // syntax to stop event bubbling or event propagation
  console.log("Parent clicked - propagation stopped");
});

child.addEventListener("click", () => {
  console.log("Child clicked");
});
```
- ##### When you click the child div:
```
Output:
Child clicked
Parent clicked - propagation stopped
// Grandparent event never fires!
```
- ##### If we clicked on child div, the propagation is stopped on parent div and does not move to grandparent div.
- ##### Hence, the event bubbling is prevented.

#### [Note: The event capturing can also be prevented using the same way.]

---
